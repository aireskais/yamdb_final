![example workflow](https://github.com/aireskais/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)
# 
### Описание:
API сервиса YaMDb, которое собирает отзывы (Review) пользователей на произведения (Titles). Произведения делятся на категории: «Книги», «Фильмы», «Музыка». Список категорий (Category) может быть расширен администратором (например, можно добавить категорию «Изобразительное искусство» или «Ювелирка»).<br/>
Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.<br/>
В каждой категории есть произведения: книги, фильмы или музыка. Например, в категории «Книги» могут быть произведения «Винни-Пух и все-все-все» и «Марсианские хроники», а в категории «Музыка» — песня «Давеча» группы «Насекомые» и вторая сюита Баха.<br/>
Произведению может быть присвоен жанр (Genre) из списка предустановленных (например, «Сказка», «Рок» или «Артхаус»). Новые жанры может создавать только администратор.<br/>
Благодарные или возмущённые пользователи оставляют к произведениям текстовые отзывы (Review) и ставят произведению оценку в диапазоне от одного до десяти (целое число); из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). На одно произведение пользователь может оставить только один отзыв.

### Стек технологий: 
Python 3, Django REST Framework, PostgreSQL, GIT, GitHub Actions

### Как запустить проект:
Клонировать репозиторий и перейти в него в командной строке:

```
git@github.com:aireskais/yamdb_final.git
```

В файле default.conf прописать IP своего сервера:

```
server {
    listen 80;
    server_name <ваш IP>;
    server_tokens off;
    location /static/ {
        root /var/html/;
    }
    location /media/ {
        root /var/html/;
    }
    location / {
        proxy_pass http://web:9000;
    }
}
```

Пушим к себе в репозиторий, и прописываем секреты:

```
DOCKER_USERNAME=<логин для докера>
DOCKER_PASSWORD=<пароль>
HOST=<IP сервера>
USER=<пользователь на сервере>
SSH_KEY=<приватный ключ от компьтера, у которого есть доступ на сервер>
PASSPHRASE=<защитный пароль для ssh ключа, если есть>
TELEGRAM_TO=<Id бота в телегра, для отправки уведомления об успешном деплое>
TELEGRAM_TOKEN=<токен для бота>
DB_ENGINE=<django.db.backends.postgresql или любой другой>
DB_NAME=<postgres или любой другой>
POSTGRES_USER=<ваш пользователь>
POSTGRES_PASSWORD=<пароль для вашего пользователя>
DB_HOST=db
DB_PORT=5432
```

Остается инициировать workflow запушив еще раз какие-либо изменения.
После удачного деплоя, на сервере выполнить миграции, создать суперпользователя и собрать статику:

```
sudo docker-compose exec web python manage.py migrate
sudo docker-compose exec web python manage.py createsuperuser
sudo docker-compose exec web python manage.py collectstatic --no-input
```

Заполнить БД тестовыми данными:

```
sudo docker-compose exec web python manage.py import_csv
```

Сервис будет доступен по адресу:

```
http://<ваш IP сервера>:9000/redoc/
```

# Автор проекта:
[Андрис](https://github.com/aireskais)
